<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Two classes: App and PresentContainer</title>
    <link rel="stylesheet" href="styles/index.css">
    <script src="scripts/present-sources.js" defer></script>
    <script src="scripts/present.js" defer></script>
    <script src="scripts/app.js" defer></script>
    <script src="scripts/main.js" defer></script>
  </head>
  <style>
    body {
      font-family: monospace;
      text-align: center;
    }

    img {
      height: 100px;
    }
  </style>
  <body>
    <h1 id="title">Click a present to open it:</h1>
    <div id="presents"></div>
  </body>
  <script>
  
  const PRESENT_SOURCES = [
    'https://media.giphy.com/media/27ppQUOxe7KlG/giphy.gif',
    'https://media.giphy.com/media/LEcRaYyUptIxG/giphy.gif',
    'https://media.giphy.com/media/3BBv1D4AFbJkY/giphy.gif',
    'https://media.giphy.com/media/13smkcXZiTLDgc/giphy.gif',
    'https://media.giphy.com/media/GknfGjiYhsFQk/giphy.gif'
  ];

  class Present {
    constructor(containerElement, presentSrc) {
      this.containerElement = containerElement;
      this.presentSrc = presentSrc;

      // Bind event listeners.
      this._openPresent = this._openPresent.bind(this);

      // Create image and append to container.
      this.image = document.createElement('img');
      this.image.src = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/1083533/gift-icon.png';
  		this.image.addEventListener('click', this._openPresent);
      this.containerElement.append(this.image);
    }

    _openPresent(event) {
      this.image.src = this.presentSrc;
    	this.image.removeEventListener('click', this._openPresent);
      document.dispatchEvent(new CustomEvent('present-opened'));
    }
  }



  class App {
    constructor(presentContainer, titleContainer) {
      this.presentContainer = presentContainer;
      this.titleContainer = titleContainer;

      this.presents = [];
      this._fillPresentContainer();

      this._onPresentOpened = this._onPresentOpened.bind(this);

      this.openedCount = 0;
      document.addEventListener('present-opened', this._onPresentOpened);
    }

    _fillPresentContainer() {
      for (const source of PRESENT_SOURCES) {
        const present = new Present(this.presentContainer, source);
        this.presents.push(present);
      }
    }

    _onPresentOpened() {
      this.openedCount++;
      if (this.openedCount === this.presents.length) {
        this.titleContainer.textContent = 'Enjoy your presents!';
      }
    }
  }



  const presentContainer = document.querySelector('#presents');
  const titleContainer = document.querySelector('#title');
  const app = new App(presentContainer, titleContainer);

  </script>
</html>
